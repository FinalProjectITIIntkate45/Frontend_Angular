<app-RecyclerLayout (sectionChange)="onSectionChange($event)">
    <div class="auctions-content">
      <!-- Filters Section -->
      <div class="filters-section content-card">
        <div class="card-header">
          <i class="fas fa-filter"></i>
          <h3>Filter Auctions</h3>
        </div>
        <div class="card-body">
          <div class="filter-row">
            <div class="filter-group">
              <label for="governorate">Cities</label>
              <select #governorateSelect class="filter-select" id="governorate" 
                      (change)="onGovernorateChange(governorateSelect.value)" [value]="selectedGovernorate">
                <option value="">All Cities</option>
                <option *ngFor="let gov of governorates" [value]="gov">
                  {{ gov }}
                </option>
              </select>
            </div>
            <div class="filter-actions">
              <button class="clear-filters-btn" 
                      (click)="selectedGovernorate = ''; onGovernorateChange('All Cities'); governorateSelect.value = 'All Cities'">
                <i class="fas fa-times"></i>
                Clear Filters
              </button>
              <button class="refresh-btn" (click)="refreshAuctions()">
                <i class="fas fa-sync-alt"></i>
                Update
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Loading State -->
      <div *ngIf="isLoading" class="loading-state content-card">
        <div class="loading-spinner">
          <i class="fas fa-spinner fa-spin"></i>
          <p>Loading auctions...</p>
        </div>
      </div>

      <!-- Auctions Grid -->
      <div class="auctions-grid" *ngIf="!isLoading && filteredAuctions.length > 0">
        <div *ngFor="let auction of filteredAuctions" class="auction-card content-card">
          <div class="card-header">
            <div class="auction-header">
              <h3 class="auction-title">
                <i class="fas fa-cube"></i>
                {{ auction.Matrialname }}
              </h3>
              <span class="auction-status" 
                    [class.active]="auction.AuctionStatus === 'Active'"
                    [class.pending]="auction.AuctionStatus === 'Pending' || auction.AuctionStatus === 'pending'"
                    [class.closed]="auction.AuctionStatus === 'Closed'">
                {{ auction.AuctionStatus }}
              </span>
            </div>
          </div>
          
          <div class="card-body">
            <div class="auction-details">
              <div class="detail-item">
                <i class="fas fa-map-marker-alt"></i>
                <span>Cities: {{ auction.GovernorateName }}</span>
              </div>
              
              <div class="detail-item">
                <i class="fas fa-calendar-plus"></i>
                <span>Start Time: {{ auction.StartTime | date:'yyyy/MM/dd HH:mm' }}</span>
              </div>
              
              <div class="detail-item">
                <i class="fas fa-calendar-check"></i>
                <span>End Time: {{ auction.EndTime | date:'yyyy/MM/dd HH:mm' }}</span>
              </div>
              
              <div class="detail-item">
                <i class="fas fa-clock"></i>
                <span>Creation Time: {{ auction.CreatedAt | date:'yyyy/MM/dd HH:mm' }}</span>
              </div>
              
              <div class="detail-item">
                <i class="fas fa-gavel"></i>
                <span>Status: {{ auction.AuctionStatus }}</span>
              </div>
              
              <div class="detail-item">
                <i class="fas fa-money-bill-wave"></i>
                <span>Insurance Amount: {{ auction.InsuranceAmount }} EGP</span>
              </div>
            </div>
            
            <div class="auction-actions">
              <!-- View Details Button -->
              <button class="view-details-btn" (click)="viewAuctionDetails(auction.Id)">
                <i class="fas fa-eye"></i>
                View Details
              </button>
              
              
              <!-- Alternative Join Button (if main button doesn't show) -->
              <button 
                      class="request-join-btn alternative" 
                      (click)="requestToJoinAuction(auction.Id)"
                      style="background: linear-gradient(135deg, #e74c3c, #c0392b);">
                <i class="fas fa-plus-circle"></i>
                Request to Join
              </button>

              <!-- Request Status Display -->
              <div *ngIf="auction.hasRequestedToJoin" class="request-status-display">
                <div class="status-badge" [class]="getRequestStatusClass(auction.requestStatus)">
                  <i class="fas fa-info-circle"></i>
                  <span>{{ getRequestStatusText(auction.requestStatus) }}</span>
                </div>
              </div>
              
              <!-- Join Room Button (always available) -->
              <button class="join-room-btn" 
                      (click)="goToAuctionRoom(auction.Id)">
                <i class="fas fa-sign-in-alt"></i>
                Join Auction Room
              </button>
              
             
            </div>
          </div>
        </div>
      </div>
      
      <!-- Pagination -->
      <div *ngIf="!isLoading && filteredAuctions.length > 0" class="pagination-section content-card">
        <div class="card-body">
          <div class="pagination-controls">
            <div class="pagination-info">
              <span>Page {{ currentPage }} of {{ totalPages }}</span>
              <span>Showing {{ (currentPage - 1) * pageSize + 1 }} to {{ Math.min(currentPage * pageSize, totalItems) }} of {{ totalItems }} auctions</span>
            </div>
            <div class="pagination-buttons">
              <button class="pagination-btn" 
                      [disabled]="currentPage === 1"
                      (click)="onPageChange(currentPage - 1)">
                <i class="fas fa-chevron-left"></i>
                Previous
              </button>
              <button class="pagination-btn" 
                      [disabled]="currentPage === totalPages"
                      (click)="onPageChange(currentPage + 1)">
                Next
                <i class="fas fa-chevron-right"></i>
              </button>
            </div>
            <div class="page-size-control">
              <label for="pageSize">Items per page:</label>
              <select #pageSizeSelect id="pageSize" 
                      [value]="pageSize"
                      (change)="onPageSizeChange(parseInt(pageSizeSelect.value))">
                <option value="5">5</option>
                <option value="10">10</option>
                <option value="20">20</option>
                <option value="50">50</option>
              </select>
            </div>
          </div>
        </div>
      </div>

      <!-- Empty State -->
      <div *ngIf="!isLoading && filteredAuctions.length === 0" class="empty-state content-card">
        <div class="empty-content">
          <i class="fas fa-search"></i>
          <h3>No auctions found</h3>
          <p>Try modifying the filters or check again later to get new auctions.</p>
          <button class="reset-btn" (click)="refreshAuctions()">
            <i class="fas fa-refresh"></i>
            View All Auctions
          </button>
        </div>
      </div>
    </div>
</app-RecyclerLayout>