<!-- Header -->
<header class="header border-bottom py-3">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-md-6">
        <h1 class="main-title">Wishlist</h1>
      </div>
      <div class="col-md-6 text-md-end">
        <span class="wishlist-counter">
          <i class="fas fa-heart me-2 text-danger"></i>
          {{ wishlistItems.length }} item(s) in wishlist
        </span>
      </div>
    </div>
  </div>
</header>

<!-- Main Content -->
<section class="main-section">
  <div class="container">
    <div class="hero-card">
      <div class="content-wrapper">
        <div class="row">
          <!-- Products Section -->
          <div class="col-lg-8">
            <div class="row">
              <div class="col-md-4 col-sm-6 mb-4" *ngFor="let item of wishlistItems">
                <div class="product-card">
                  <div class="product-image" [style.background-image]="'url(' + item.ProductImage + ')'">
                    <div class="discount-tag" *ngIf="item.DiscountPercentage">
                      {{ item.DiscountPercentage * 100 | number:'1.0-0' }}% OFF
                    </div>
                    <div class="wishlist-icon" (click)="toggleWishlist(item)">
                      <i [ngClass]="wishlistProductIds.has(item.ProductId) ? 'fas fa-heart' : 'far fa-heart'"></i>
                    </div>
                  </div>
                  <div class="product-details">
                    <h3 class="product-name">{{ item.ProductName }}</h3>
                    <p class="product-price">${{ item.ProductPrice | number:'1.2-2' }}</p>
                    <button class="add-to-bag" (click)="addToCart(item)">
                      <i class="fas fa-shopping-cart me-2"></i>
                      Add to Cart
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <div *ngIf="!wishlistItems.length" class="empty-wishlist">
              <div class="empty-icon">
                <i class="fas fa-heart-broken"></i>
              </div>
              <h3>Your wishlist is empty</h3>
              <p>Start adding items to your wishlist to see them here!</p>
            </div>
          </div>

          <!-- Special Request Form -->
          <div class="col-lg-4">
            <div class="special-request">
              <div class="special-request-header">
                <div class="request-icon">
                  <i class="fas fa-magic"></i>
                </div>
                <h2>Special Request</h2>
              </div>
              <p class="request-description">
                Can't find what you're looking for? Let us know and we'll try to get it for you.
              </p>

              <form [formGroup]="specialRequestForm" (ngSubmit)="submitSpecialRequest()">
                <div class="form-group">
                  <label for="productName" class="form-label">
                    <i class="fas fa-tag me-2"></i>Product Name
                  </label>
                  <input type="text" class="form-control" id="productName" formControlName="productName"
                    placeholder="e.g., brand or specific model">
                  <div
                    *ngIf="specialRequestForm.get('productName')?.invalid && specialRequestForm.get('productName')?.touched"
                    class="error-message">
                    Product name is required.
                  </div>
                </div>

                <div class="form-group">
                  <label for="productDescription" class="form-label">
                    <i class="fas fa-align-left me-2"></i>Description
                  </label>
                  <textarea class="form-control" id="productDescription" rows="3" formControlName="productDescription"
                    placeholder="Please provide details"></textarea>
                  <div
                    *ngIf="specialRequestForm.get('productDescription')?.invalid && specialRequestForm.get('productDescription')?.touched"
                    class="error-message">
                    Description is required.
                  </div>
                </div>

                <div class="form-group">
                  <label for="priceRange" class="form-label">
                    <i class="fas fa-dollar-sign me-2"></i>Price Range
                  </label>
                  <select class="form-select" id="priceRange" formControlName="priceRange">
                    <option value="" disabled selected>Select price range</option>
                    <option value="1">Under $50</option>
                    <option value="2">$50 - $100</option>
                    <option value="3">$100 - $200</option>
                    <option value="4">$200+</option>
                  </select>
                  <div
                    *ngIf="specialRequestForm.get('priceRange')?.invalid && specialRequestForm.get('priceRange')?.touched"
                    class="error-message">
                    Price range is required.
                  </div>
                </div>

                <button type="submit" class="submit-request" [disabled]="specialRequestForm.invalid">
                  <i class="fas fa-paper-plane me-2"></i>
                  Submit Request
                </button>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<div *ngIf="errorMessage" class="alert-message">
  <div class="container">
    <div class="alert-content">
      <i class="fas fa-info-circle me-2"></i>
      {{ errorMessage }}
    </div>
  </div>
</div>